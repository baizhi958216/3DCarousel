"use strict";(()=>{var d=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var c=d(s=>{Object.defineProperty(s,"__esModule",{value:!0});s.initCarousel=s.CarouselItem=s.Carousel=void 0;var r=class{element;fullWidth;constructor(e,t){this.element=e,this.fullWidth=e.offsetWidth,this.element.style.display="inline-block",this.element.style.position="absolute",this.element.style.transformOrigin="0 0"}moveTo(e,t,i){this.element.style.zIndex=`${i*100|0}`,this.element.style.transform=`translate(${e}px, ${t}px) scale(${i})`}};s.CarouselItem=r;var l=class{element;options;items;xOrigin;yOrigin;xRadius;yRadius;farScale;rotation;destRotation;speed;timer;frontItemClass;onLoaded;onRendered;onAnimationFinished;itemOptions;lastTime;initTimer;constructor(e,t){this.element=e,this.options=t,this.items=[],this.xOrigin=t.xOrigin??e.clientWidth*.5,this.yOrigin=t.yOrigin??e.clientHeight*.1,this.xRadius=t.xRadius??e.clientWidth/2.3,this.yRadius=t.yRadius??e.clientHeight/6,this.farScale=t.farScale,this.rotation=this.destRotation=Math.PI/2,this.speed=t.speed,this.timer=0,this.frontItemClass=t.frontItemClass,this.onLoaded=t.onLoaded,this.onRendered=t.onRendered,this.onAnimationFinished=t.onAnimationFinished,this.itemOptions={},this.element.style.position="relative",this.element.style.overflow="hidden",this.lastTime=performance.now(),this.initTimer=setInterval(()=>{this.finishInit()},50)}renderItem=(e,t)=>{let i=this.items[e],a=Math.sin(t),o=this.farScale,h=o+(1-o)*(a+1)*.5;return i.moveTo(this.xOrigin+h*(Math.cos(t)*this.xRadius-i.fullWidth*.5),this.yOrigin+h*a*this.yRadius,h),i};render=()=>{let e=this.items.length,t=2*Math.PI/e,i=this.rotation,a=Math.round(this.floatIndex())%this.items.length;for(let o=0;o<e;o++){let h=this.renderItem(o,i);o===a?h.element.classList.add(this.frontItemClass):h.element.classList.remove(this.frontItemClass),i+=t}typeof this.onRendered=="function"&&this.onRendered(this)};playFrame=()=>{let e=this.destRotation-this.rotation,t=performance.now(),i=(t-this.lastTime)*.002;this.lastTime=t,Math.abs(e)<.003?(this.rotation=this.destRotation,this.pause(),typeof this.onAnimationFinished=="function"&&this.onAnimationFinished()):(this.rotation=this.destRotation-e/(1+this.speed*i),this.scheduleNextFrame()),this.render()};scheduleNextFrame=()=>{this.lastTime=performance.now(),this.timer=window.requestAnimationFrame(this.playFrame)};itemsRotated=()=>this.items.length*(Math.PI/2-this.rotation)/(2*Math.PI);floatIndex=()=>{let e=this.items.length,t=this.itemsRotated()%e;return t<0?t+e:t};play=()=>{this.timer===0&&this.scheduleNextFrame()};pause=()=>{window.cancelAnimationFrame(this.timer),this.timer=0};go=e=>{this.destRotation+=2*Math.PI/this.items.length*e,this.play()};goTo=e=>{let t=this.items.length,i=e-this.floatIndex()%t;return 2*Math.abs(i)>t&&(i-=i>0?t:-t),this.destRotation=this.rotation,this.go(-i),i};finishInit=()=>{clearInterval(this.initTimer);let e=this.element.querySelectorAll(`.${this.options.itemClass}`);for(let t=0;t<e.length;t++)this.items.push(new r(e[t],this.itemOptions)),e[t].addEventListener("mousedown",()=>this.goTo(t)),this.render()}};s.Carousel=l;var m=(n={farScale:.5,speed:4,itemClass:"carousel",handle:"carousel-item"})=>{if(!document.querySelector(n.handle))throw Error("\u672A\u627E\u5230\u6302\u8F7D\u70B9 \u65E0\u6CD5\u65B0\u5EFA\u5B9E\u4F8B");new l(document.querySelector(n.handle),n)};s.initCarousel=m});c();})();
